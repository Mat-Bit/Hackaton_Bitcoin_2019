/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectorRef, Component, ContentChildren, QueryList, ViewChild } from '@angular/core';
import { isMobile } from './../../utils/util';
import { PoTabComponent } from './po-tab/po-tab.component';
import { PoTabDropdownComponent } from './po-tab-dropdown/po-tab-dropdown.component';
import { PoTabsBaseComponent } from './po-tabs-base.component';
/** @type {?} */
var poTabsMaxNumberOfTabs = 5;
/**
 * \@docsExtends PoTabsBaseComponent
 *
 * \@example
 *
 * <example name="po-tabs-basic" title="Portinari Tabs Basic">
 *  <file name="sample-po-tabs-basic/sample-po-tabs-basic.component.html"> </file>
 *  <file name="sample-po-tabs-basic/sample-po-tabs-basic.component.ts"> </file>
 * </example>
 *
 * <example name="po-tabs-labs" title="Portinari Tabs Labs">
 *  <file name="sample-po-tabs-labs/sample-po-tabs-labs.component.html"> </file>
 *  <file name="sample-po-tabs-labs/sample-po-tabs-labs.component.ts"> </file>
 * </example>
 *
 * <example name="po-tabs-travel" title="Portinari Tabs - Travel">
 *  <file name="sample-po-tabs-travel/sample-po-tabs-travel.component.html"> </file>
 *  <file name="sample-po-tabs-travel/sample-po-tabs-travel.component.ts"> </file>
 * </example>
 *
 * <example name="po-tabs-business-conf" title="Portinari Tabs - Business Conference">
 *  <file name="sample-po-tabs-business-conf/sample-po-tabs-business-conf.component.html"> </file>
 *  <file name="sample-po-tabs-business-conf/sample-po-tabs-business-conf.component.ts"> </file>
 * </example>
 */
var PoTabsComponent = /** @class */ (function (_super) {
    tslib_1.__extends(PoTabsComponent, _super);
    function PoTabsComponent(changeDetector) {
        var _this = _super.call(this) || this;
        _this.changeDetector = changeDetector;
        _this.maxNumberOfTabs = poTabsMaxNumberOfTabs;
        return _this;
    }
    Object.defineProperty(PoTabsComponent.prototype, "isMobileDevice", {
        get: /**
         * @return {?}
         */
        function () {
            return isMobile();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoTabsComponent.prototype, "isShowTabDropdown", {
        get: /**
         * @return {?}
         */
        function () {
            return !this.isMobileDevice && this.visibleTabs.length > this.maxNumberOfTabs;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoTabsComponent.prototype, "overflowedTabs", {
        // tabs que serão apresentadas na aba "Mais"
        get: 
        // tabs que serão apresentadas na aba "Mais"
        /**
         * @return {?}
         */
        function () {
            var _this = this;
            return this.visibleTabs.filter((/**
             * @param {?} _tab
             * @param {?} index
             * @return {?}
             */
            function (_tab, index) { return index > (_this.maxNumberOfTabs - 2); }));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PoTabsComponent.prototype, "visibleTabs", {
        get: /**
         * @return {?}
         */
        function () {
            return this.tabs.filter((/**
             * @param {?} tab
             * @return {?}
             */
            function (tab) { return !tab.hide; }));
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    PoTabsComponent.prototype.closePopover = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var containsPopoverVisible = this.tabDropdown && this.tabDropdown.popover && !this.tabDropdown.popover.isHidden;
        if (containsPopoverVisible) {
            this.tabDropdown.popover.close();
        }
    };
    /**
     * @param {?} tab
     * @return {?}
     */
    PoTabsComponent.prototype.isVisibleTab = /**
     * @param {?} tab
     * @return {?}
     */
    function (tab) {
        if (this.isMobileDevice) {
            return true;
        }
        /** @type {?} */
        var visibleTabIndex = this.visibleTabs.findIndex((/**
         * @param {?} visibleTab
         * @return {?}
         */
        function (visibleTab) { return visibleTab.id === tab.id; }));
        return (this.visibleTabs.length <= this.maxNumberOfTabs) || (visibleTabIndex < (this.maxNumberOfTabs - 1));
    };
    // Função disparada quando alguma tab ficar ativa
    // Função disparada quando alguma tab ficar ativa
    /**
     * @param {?} tab
     * @return {?}
     */
    PoTabsComponent.prototype.onTabActive = 
    // Função disparada quando alguma tab ficar ativa
    /**
     * @param {?} tab
     * @return {?}
     */
    function (tab) {
        this.previousActiveTab = this.tabs.find((/**
         * @param {?} tabChild
         * @return {?}
         */
        function (tabChild) { return tabChild.active && tabChild.id !== tab.id; }));
        this.deactivateTab();
    };
    // funcao será disparada quando mudar o estado do poTab para desabilitado ou escondido.
    // funcao será disparada quando mudar o estado do poTab para desabilitado ou escondido.
    /**
     * @param {?} tab
     * @return {?}
     */
    PoTabsComponent.prototype.onTabChangeState = 
    // funcao será disparada quando mudar o estado do poTab para desabilitado ou escondido.
    /**
     * @param {?} tab
     * @return {?}
     */
    function (tab) {
        if (tab.active) {
            tab.active = false;
            this.activeDistinctTab();
            this.changeDetector.detectChanges();
        }
    };
    // selectiona a aba informada por parametro, caso houver click faz a emição do evento.
    // selectiona a aba informada por parametro, caso houver click faz a emição do evento.
    /**
     * @param {?} tab
     * @return {?}
     */
    PoTabsComponent.prototype.selectedTab = 
    // selectiona a aba informada por parametro, caso houver click faz a emição do evento.
    /**
     * @param {?} tab
     * @return {?}
     */
    function (tab) {
        tab.active = true;
        if (tab.click) {
            tab.click.emit(tab);
        }
        this.changeDetector.detectChanges();
    };
    /**
     * @param {?} _i
     * @param {?} tab
     * @return {?}
     */
    PoTabsComponent.prototype.trackByFn = /**
     * @param {?} _i
     * @param {?} tab
     * @return {?}
     */
    function (_i, tab) {
        return tab.id;
    };
    // ativa a previousActiveTab ou primeira tab encontrada.
    // ativa a previousActiveTab ou primeira tab encontrada.
    /**
     * @private
     * @return {?}
     */
    PoTabsComponent.prototype.activeDistinctTab = 
    // ativa a previousActiveTab ou primeira tab encontrada.
    /**
     * @private
     * @return {?}
     */
    function () {
        if (this.previousActiveTab) {
            this.previousActiveTab.active = true;
        }
        else {
            this.activeFirstTab();
        }
    };
    // Ativa a primeira Tab que não estiver desabilitada ou escondida.
    // Ativa a primeira Tab que não estiver desabilitada ou escondida.
    /**
     * @private
     * @return {?}
     */
    PoTabsComponent.prototype.activeFirstTab = 
    // Ativa a primeira Tab que não estiver desabilitada ou escondida.
    /**
     * @private
     * @return {?}
     */
    function () {
        this.tabs.some((/**
         * @param {?} tabChild
         * @return {?}
         */
        function (tabChild) {
            if (!tabChild.disabled && !tabChild.hide) {
                tabChild.active = true;
                return true;
            }
        }));
    };
    // desativa previousActiveTab e dispara a detecção de mudança.
    // desativa previousActiveTab e dispara a detecção de mudança.
    /**
     * @private
     * @return {?}
     */
    PoTabsComponent.prototype.deactivateTab = 
    // desativa previousActiveTab e dispara a detecção de mudança.
    /**
     * @private
     * @return {?}
     */
    function () {
        if (this.previousActiveTab) {
            this.previousActiveTab.active = false;
            this.changeDetector.detectChanges();
        }
    };
    PoTabsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'po-tabs',
                    template: "<div class=\"po-tabs-container\"\n  [class.po-tabs-container-mobile]=\"isMobileDevice\">\n  <div class=\"po-tabs-header\">\n\n    <ng-container *ngFor=\"let tab of tabs; trackBy: trackByFn\">\n      <po-tab-button *ngIf=\"isVisibleTab(tab)\"\n        class=\"po-tab-button\"\n        [class.po-tab-button-mobile]=\"isMobileDevice\"\n        [p-active]=\"tab.active\"\n        [p-disabled]=\"tab.disabled\"\n        [p-hide]=\"tab.hide\"\n        [p-id]=\"tab.id\"\n        [p-label]=\"tab.label\"\n        [p-small]=\"small\"\n        (keyup.enter)=\"closePopover()\"\n        (p-activated)=\"onTabActive(tab)\"\n        (p-change-state)=\"onTabChangeState(tab)\"\n        (p-click)=\"selectedTab(tab)\">\n      </po-tab-button>\n    </ng-container>\n\n    <po-tab-dropdown #tabDropdown\n      *ngIf=\"isShowTabDropdown\"\n      class=\"po-tab-button po-tab-dropdown\"\n      p-label=\"Mais\"\n      [p-small]=\"small\"\n      [p-tabs]=\"overflowedTabs\"\n      (p-activated)=\"onTabActive($event)\"\n      (p-change-state)=\"onTabChangeState($event)\"\n      (p-click)=\"selectedTab($event)\">\n    </po-tab-dropdown>\n  </div>\n</div>\n\n<div class=\"po-tabs-content\">\n  <ng-content></ng-content>\n</div>\n\n"
                }] }
    ];
    /** @nocollapse */
    PoTabsComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef }
    ]; };
    PoTabsComponent.propDecorators = {
        tabs: [{ type: ContentChildren, args: [PoTabComponent,] }],
        tabDropdown: [{ type: ViewChild, args: ['tabDropdown', { static: true },] }]
    };
    return PoTabsComponent;
}(PoTabsBaseComponent));
export { PoTabsComponent };
if (false) {
    /** @type {?} */
    PoTabsComponent.prototype.maxNumberOfTabs;
    /**
     * @type {?}
     * @private
     */
    PoTabsComponent.prototype.previousActiveTab;
    /** @type {?} */
    PoTabsComponent.prototype.tabs;
    /** @type {?} */
    PoTabsComponent.prototype.tabDropdown;
    /**
     * @type {?}
     * @private
     */
    PoTabsComponent.prototype.changeDetector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tdGFicy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AcG9ydGluYXJpL3BvcnRpbmFyaS11aS8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL3BvLXRhYnMvcG8tdGFicy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBHLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUU5QyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDM0QsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNkNBQTZDLENBQUM7QUFDckYsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7O0lBRXpELHFCQUFxQixHQUFHLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBMkIvQjtJQUlxQywyQ0FBbUI7SUFXdEQseUJBQW9CLGNBQWlDO1FBQXJELFlBQ0UsaUJBQU8sU0FDUjtRQUZtQixvQkFBYyxHQUFkLGNBQWMsQ0FBbUI7UUFUckQscUJBQWUsR0FBRyxxQkFBcUIsQ0FBQzs7SUFXeEMsQ0FBQztJQUVELHNCQUFJLDJDQUFjOzs7O1FBQWxCO1lBQ0UsT0FBTyxRQUFRLEVBQUUsQ0FBQztRQUNwQixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLDhDQUFpQjs7OztRQUFyQjtZQUNFLE9BQU8sQ0FBQyxJQUFJLENBQUMsY0FBYyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7UUFDaEYsQ0FBQzs7O09BQUE7SUFHRCxzQkFBSSwyQ0FBYztRQURsQiw0Q0FBNEM7Ozs7OztRQUM1QztZQUFBLGlCQUVDO1lBREMsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU07Ozs7O1lBQUMsVUFBQyxJQUFJLEVBQUUsS0FBSyxJQUFLLE9BQUEsS0FBSyxHQUFHLENBQUMsS0FBSSxDQUFDLGVBQWUsR0FBRyxDQUFDLENBQUMsRUFBbEMsQ0FBa0MsRUFBQyxDQUFDO1FBQ3RGLENBQUM7OztPQUFBO0lBRUQsc0JBQUksd0NBQVc7Ozs7UUFBZjtZQUNFLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNOzs7O1lBQUMsVUFBQSxHQUFHLElBQUksT0FBQSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQVQsQ0FBUyxFQUFDLENBQUM7UUFDNUMsQ0FBQzs7O09BQUE7Ozs7SUFFRCxzQ0FBWTs7O0lBQVo7O1lBQ1Esc0JBQXNCLEdBQUcsSUFBSSxDQUFDLFdBQVcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLFFBQVE7UUFFakgsSUFBSSxzQkFBc0IsRUFBRTtZQUMxQixJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztTQUNsQztJQUNILENBQUM7Ozs7O0lBRUQsc0NBQVk7Ozs7SUFBWixVQUFhLEdBQUc7UUFDZCxJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDdkIsT0FBTyxJQUFJLENBQUM7U0FDYjs7WUFFSyxlQUFlLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQSxVQUFVLElBQUksT0FBQSxVQUFVLENBQUMsRUFBRSxLQUFLLEdBQUcsQ0FBQyxFQUFFLEVBQXhCLENBQXdCLEVBQUM7UUFFMUYsT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLGVBQWUsR0FBRyxDQUFDLElBQUksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3RyxDQUFDO0lBRUQsaURBQWlEOzs7Ozs7SUFDakQscUNBQVc7Ozs7OztJQUFYLFVBQVksR0FBRztRQUNiLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUk7Ozs7UUFBQyxVQUFBLFFBQVEsSUFBSSxPQUFBLFFBQVEsQ0FBQyxNQUFNLElBQUksUUFBUSxDQUFDLEVBQUUsS0FBSyxHQUFHLENBQUMsRUFBRSxFQUF6QyxDQUF5QyxFQUFDLENBQUM7UUFFL0YsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7SUFFRCx1RkFBdUY7Ozs7OztJQUN2RiwwQ0FBZ0I7Ozs7OztJQUFoQixVQUFpQixHQUFtQjtRQUNsQyxJQUFJLEdBQUcsQ0FBQyxNQUFNLEVBQUU7WUFDZCxHQUFHLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztZQUVuQixJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUV6QixJQUFJLENBQUMsY0FBYyxDQUFDLGFBQWEsRUFBRSxDQUFDO1NBQ3JDO0lBQ0gsQ0FBQztJQUVELHNGQUFzRjs7Ozs7O0lBQ3RGLHFDQUFXOzs7Ozs7SUFBWCxVQUFZLEdBQW1CO1FBQzdCLEdBQUcsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO1FBRWxCLElBQUksR0FBRyxDQUFDLEtBQUssRUFBRTtZQUNiLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3JCO1FBRUQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN0QyxDQUFDOzs7Ozs7SUFFRCxtQ0FBUzs7Ozs7SUFBVCxVQUFVLEVBQUUsRUFBRSxHQUFtQjtRQUMvQixPQUFPLEdBQUcsQ0FBQyxFQUFFLENBQUM7SUFDaEIsQ0FBQztJQUVELHdEQUF3RDs7Ozs7O0lBQ2hELDJDQUFpQjs7Ozs7O0lBQXpCO1FBQ0UsSUFBSSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDMUIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7U0FDdEM7YUFBTTtZQUNMLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztTQUN2QjtJQUNILENBQUM7SUFFRCxrRUFBa0U7Ozs7OztJQUMxRCx3Q0FBYzs7Ozs7O0lBQXRCO1FBQ0UsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJOzs7O1FBQUMsVUFBQSxRQUFRO1lBQ3JCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRTtnQkFDeEMsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7Z0JBQ3ZCLE9BQU8sSUFBSSxDQUFDO2FBQ2I7UUFDSCxDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCw4REFBOEQ7Ozs7OztJQUN0RCx1Q0FBYTs7Ozs7O0lBQXJCO1FBQ0UsSUFBSSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDMUIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7WUFFdEMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztTQUNyQztJQUNILENBQUM7O2dCQWpIRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLFNBQVM7b0JBQ25CLHdzQ0FBdUM7aUJBQ3hDOzs7O2dCQXRDUSxpQkFBaUI7Ozt1QkE4Q3ZCLGVBQWUsU0FBQyxjQUFjOzhCQUU5QixTQUFTLFNBQUMsYUFBYSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTs7SUFzRzVDLHNCQUFDO0NBQUEsQUFuSEQsQ0FJcUMsbUJBQW1CLEdBK0d2RDtTQS9HWSxlQUFlOzs7SUFFMUIsMENBQXdDOzs7OztJQUV4Qyw0Q0FBMEM7O0lBRzFDLCtCQUFpRTs7SUFFakUsc0NBQWdGOzs7OztJQUVwRSx5Q0FBeUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBDb250ZW50Q2hpbGRyZW4sIFF1ZXJ5TGlzdCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IGlzTW9iaWxlIH0gZnJvbSAnLi8uLi8uLi91dGlscy91dGlsJztcblxuaW1wb3J0IHsgUG9UYWJDb21wb25lbnQgfSBmcm9tICcuL3BvLXRhYi9wby10YWIuY29tcG9uZW50JztcbmltcG9ydCB7IFBvVGFiRHJvcGRvd25Db21wb25lbnQgfSBmcm9tICcuL3BvLXRhYi1kcm9wZG93bi9wby10YWItZHJvcGRvd24uY29tcG9uZW50JztcbmltcG9ydCB7IFBvVGFic0Jhc2VDb21wb25lbnQgfSBmcm9tICcuL3BvLXRhYnMtYmFzZS5jb21wb25lbnQnO1xuXG5jb25zdCBwb1RhYnNNYXhOdW1iZXJPZlRhYnMgPSA1O1xuXG4vKipcbiAqIEBkb2NzRXh0ZW5kcyBQb1RhYnNCYXNlQ29tcG9uZW50XG4gKlxuICogQGV4YW1wbGVcbiAqXG4gKiA8ZXhhbXBsZSBuYW1lPVwicG8tdGFicy1iYXNpY1wiIHRpdGxlPVwiUG9ydGluYXJpIFRhYnMgQmFzaWNcIj5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLXRhYnMtYmFzaWMvc2FtcGxlLXBvLXRhYnMtYmFzaWMuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tdGFicy1iYXNpYy9zYW1wbGUtcG8tdGFicy1iYXNpYy5jb21wb25lbnQudHNcIj4gPC9maWxlPlxuICogPC9leGFtcGxlPlxuICpcbiAqIDxleGFtcGxlIG5hbWU9XCJwby10YWJzLWxhYnNcIiB0aXRsZT1cIlBvcnRpbmFyaSBUYWJzIExhYnNcIj5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLXRhYnMtbGFicy9zYW1wbGUtcG8tdGFicy1sYWJzLmNvbXBvbmVudC5odG1sXCI+IDwvZmlsZT5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLXRhYnMtbGFicy9zYW1wbGUtcG8tdGFicy1sYWJzLmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInBvLXRhYnMtdHJhdmVsXCIgdGl0bGU9XCJQb3J0aW5hcmkgVGFicyAtIFRyYXZlbFwiPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tdGFicy10cmF2ZWwvc2FtcGxlLXBvLXRhYnMtdHJhdmVsLmNvbXBvbmVudC5odG1sXCI+IDwvZmlsZT5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXBvLXRhYnMtdHJhdmVsL3NhbXBsZS1wby10YWJzLXRyYXZlbC5jb21wb25lbnQudHNcIj4gPC9maWxlPlxuICogPC9leGFtcGxlPlxuICpcbiAqIDxleGFtcGxlIG5hbWU9XCJwby10YWJzLWJ1c2luZXNzLWNvbmZcIiB0aXRsZT1cIlBvcnRpbmFyaSBUYWJzIC0gQnVzaW5lc3MgQ29uZmVyZW5jZVwiPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tdGFicy1idXNpbmVzcy1jb25mL3NhbXBsZS1wby10YWJzLWJ1c2luZXNzLWNvbmYuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtcG8tdGFicy1idXNpbmVzcy1jb25mL3NhbXBsZS1wby10YWJzLWJ1c2luZXNzLWNvbmYuY29tcG9uZW50LnRzXCI+IDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncG8tdGFicycsXG4gIHRlbXBsYXRlVXJsOiAnLi9wby10YWJzLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBQb1RhYnNDb21wb25lbnQgZXh0ZW5kcyBQb1RhYnNCYXNlQ29tcG9uZW50IHtcblxuICBtYXhOdW1iZXJPZlRhYnMgPSBwb1RhYnNNYXhOdW1iZXJPZlRhYnM7XG5cbiAgcHJpdmF0ZSBwcmV2aW91c0FjdGl2ZVRhYjogUG9UYWJDb21wb25lbnQ7XG5cbiAgLy8gVGFicyB1dGlsaXphZG9zIG5vIG5nLWNvbnRlbnRcbiAgQENvbnRlbnRDaGlsZHJlbihQb1RhYkNvbXBvbmVudCkgdGFiczogUXVlcnlMaXN0PFBvVGFiQ29tcG9uZW50PjtcblxuICBAVmlld0NoaWxkKCd0YWJEcm9wZG93bicsIHsgc3RhdGljOiB0cnVlIH0pIHRhYkRyb3Bkb3duOiBQb1RhYkRyb3Bkb3duQ29tcG9uZW50O1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY2hhbmdlRGV0ZWN0b3I6IENoYW5nZURldGVjdG9yUmVmKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIGdldCBpc01vYmlsZURldmljZSgpIHtcbiAgICByZXR1cm4gaXNNb2JpbGUoKTtcbiAgfVxuXG4gIGdldCBpc1Nob3dUYWJEcm9wZG93bigpIHtcbiAgICByZXR1cm4gIXRoaXMuaXNNb2JpbGVEZXZpY2UgJiYgdGhpcy52aXNpYmxlVGFicy5sZW5ndGggPiB0aGlzLm1heE51bWJlck9mVGFicztcbiAgfVxuXG4gIC8vIHRhYnMgcXVlIHNlcsOjbyBhcHJlc2VudGFkYXMgbmEgYWJhIFwiTWFpc1wiXG4gIGdldCBvdmVyZmxvd2VkVGFicygpIHtcbiAgICByZXR1cm4gdGhpcy52aXNpYmxlVGFicy5maWx0ZXIoKF90YWIsIGluZGV4KSA9PiBpbmRleCA+ICh0aGlzLm1heE51bWJlck9mVGFicyAtIDIpKTtcbiAgfVxuXG4gIGdldCB2aXNpYmxlVGFicygpIHtcbiAgICByZXR1cm4gdGhpcy50YWJzLmZpbHRlcih0YWIgPT4gIXRhYi5oaWRlKTtcbiAgfVxuXG4gIGNsb3NlUG9wb3ZlcigpOiB2b2lkIHtcbiAgICBjb25zdCBjb250YWluc1BvcG92ZXJWaXNpYmxlID0gdGhpcy50YWJEcm9wZG93biAmJiB0aGlzLnRhYkRyb3Bkb3duLnBvcG92ZXIgJiYgIXRoaXMudGFiRHJvcGRvd24ucG9wb3Zlci5pc0hpZGRlbjtcblxuICAgIGlmIChjb250YWluc1BvcG92ZXJWaXNpYmxlKSB7XG4gICAgICB0aGlzLnRhYkRyb3Bkb3duLnBvcG92ZXIuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBpc1Zpc2libGVUYWIodGFiKSB7XG4gICAgaWYgKHRoaXMuaXNNb2JpbGVEZXZpY2UpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGNvbnN0IHZpc2libGVUYWJJbmRleCA9IHRoaXMudmlzaWJsZVRhYnMuZmluZEluZGV4KHZpc2libGVUYWIgPT4gdmlzaWJsZVRhYi5pZCA9PT0gdGFiLmlkKTtcblxuICAgIHJldHVybiAodGhpcy52aXNpYmxlVGFicy5sZW5ndGggPD0gdGhpcy5tYXhOdW1iZXJPZlRhYnMpIHx8ICh2aXNpYmxlVGFiSW5kZXggPCAodGhpcy5tYXhOdW1iZXJPZlRhYnMgLSAxKSk7XG4gIH1cblxuICAvLyBGdW7Dp8OjbyBkaXNwYXJhZGEgcXVhbmRvIGFsZ3VtYSB0YWIgZmljYXIgYXRpdmFcbiAgb25UYWJBY3RpdmUodGFiKSB7XG4gICAgdGhpcy5wcmV2aW91c0FjdGl2ZVRhYiA9IHRoaXMudGFicy5maW5kKHRhYkNoaWxkID0+IHRhYkNoaWxkLmFjdGl2ZSAmJiB0YWJDaGlsZC5pZCAhPT0gdGFiLmlkKTtcblxuICAgIHRoaXMuZGVhY3RpdmF0ZVRhYigpO1xuICB9XG5cbiAgLy8gZnVuY2FvIHNlcsOhIGRpc3BhcmFkYSBxdWFuZG8gbXVkYXIgbyBlc3RhZG8gZG8gcG9UYWIgcGFyYSBkZXNhYmlsaXRhZG8gb3UgZXNjb25kaWRvLlxuICBvblRhYkNoYW5nZVN0YXRlKHRhYjogUG9UYWJDb21wb25lbnQpIHtcbiAgICBpZiAodGFiLmFjdGl2ZSkge1xuICAgICAgdGFiLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICB0aGlzLmFjdGl2ZURpc3RpbmN0VGFiKCk7XG5cbiAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0ZWN0Q2hhbmdlcygpO1xuICAgIH1cbiAgfVxuXG4gIC8vIHNlbGVjdGlvbmEgYSBhYmEgaW5mb3JtYWRhIHBvciBwYXJhbWV0cm8sIGNhc28gaG91dmVyIGNsaWNrIGZheiBhIGVtacOnw6NvIGRvIGV2ZW50by5cbiAgc2VsZWN0ZWRUYWIodGFiOiBQb1RhYkNvbXBvbmVudCkge1xuICAgIHRhYi5hY3RpdmUgPSB0cnVlO1xuXG4gICAgaWYgKHRhYi5jbGljaykge1xuICAgICAgdGFiLmNsaWNrLmVtaXQodGFiKTtcbiAgICB9XG5cbiAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG4gIHRyYWNrQnlGbihfaSwgdGFiOiBQb1RhYkNvbXBvbmVudCkge1xuICAgIHJldHVybiB0YWIuaWQ7XG4gIH1cblxuICAvLyBhdGl2YSBhIHByZXZpb3VzQWN0aXZlVGFiIG91IHByaW1laXJhIHRhYiBlbmNvbnRyYWRhLlxuICBwcml2YXRlIGFjdGl2ZURpc3RpbmN0VGFiKCkge1xuICAgIGlmICh0aGlzLnByZXZpb3VzQWN0aXZlVGFiKSB7XG4gICAgICB0aGlzLnByZXZpb3VzQWN0aXZlVGFiLmFjdGl2ZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWN0aXZlRmlyc3RUYWIoKTtcbiAgICB9XG4gIH1cblxuICAvLyBBdGl2YSBhIHByaW1laXJhIFRhYiBxdWUgbsOjbyBlc3RpdmVyIGRlc2FiaWxpdGFkYSBvdSBlc2NvbmRpZGEuXG4gIHByaXZhdGUgYWN0aXZlRmlyc3RUYWIoKSB7XG4gICAgdGhpcy50YWJzLnNvbWUodGFiQ2hpbGQgPT4ge1xuICAgICAgaWYgKCF0YWJDaGlsZC5kaXNhYmxlZCAmJiAhdGFiQ2hpbGQuaGlkZSkge1xuICAgICAgICB0YWJDaGlsZC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8vIGRlc2F0aXZhIHByZXZpb3VzQWN0aXZlVGFiIGUgZGlzcGFyYSBhIGRldGVjw6fDo28gZGUgbXVkYW7Dp2EuXG4gIHByaXZhdGUgZGVhY3RpdmF0ZVRhYigpIHtcbiAgICBpZiAodGhpcy5wcmV2aW91c0FjdGl2ZVRhYikge1xuICAgICAgdGhpcy5wcmV2aW91c0FjdGl2ZVRhYi5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgfVxuICB9XG5cbn1cbiJdfQ==