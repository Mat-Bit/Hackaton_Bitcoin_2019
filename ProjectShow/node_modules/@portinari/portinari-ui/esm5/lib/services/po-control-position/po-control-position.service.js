/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ElementRef, Injectable } from '@angular/core';
/**
 * \@docsPrivate
 * \@description
 *
 * Serviço responsável por gerenciar as posições de um elemento em relação a um elemento alvo. Ele pode receber as
 * seguintes posições:
 *
 * - `right`: Posiciona o elemento no lado direito do componente alvo.
 * - `right-bottom`: Posiciona o elemento no lado direito inferior do componente alvo.
 * - `right-top`: Posiciona o elemento no lado direito superior do componente alvo.
 * - `bottom`: Posiciona o elemento abaixo do componente alvo.
 * - `bottom-left`: Posiciona o elemento abaixo e à esquerda do componente alvo.
 * - `bottom-right`: Posiciona o elemento abaixo e à direita do componente alvo.
 * - `left`: Posiciona o elemento no lado esquerdo do componente alvo.
 * - `left-top`: Posiciona o elemento no lado esquerdo superior do componente alvo.
 * - `left-bottom`: Posiciona o elemento no lado esquerdo inferior do componente alvo.
 * - `top`: Posiciona o elemento acima do componente alvo.
 * - `top-right`: Posiciona o elemento acima e à direita do componente alvo.
 * - `top-left`: Posiciona o elemento acima e à esquerda do componente alvo.
 *
 * Caso o elemento não caiba na tela na posição indicada ele será rotacionado automaticamente para se adequar,
 * inicialmente no lado definido como padrão e em seguida seguindo o sentido horário.
 * @type {?}
 */
var poControlPositionSidesDefault = [
    'bottom', 'bottom-left', 'bottom-right',
    'left', 'left-top', 'left-bottom',
    'top', 'top-right', 'top-left',
    'right', 'right-bottom', 'right-top'
];
var PoControlPositionService = /** @class */ (function () {
    function PoControlPositionService() {
        this.differenceDiagonalToWidthArrow = 3;
        this.isSetElementWidth = false;
        // offset da seta em relação ao canto do componente
        this.offsetArrow = 12;
    }
    /**
     * @description Ajusta a posição do elemento, caso não couber em tela irá para próxima posição.
     *
     * @param value posição para exibição do elemento
     */
    /**
     * \@description Ajusta a posição do elemento, caso não couber em tela irá para próxima posição.
     *
     * @param {?} value posição para exibição do elemento
     * @return {?}
     */
    PoControlPositionService.prototype.adjustPosition = /**
     * \@description Ajusta a posição do elemento, caso não couber em tela irá para próxima posição.
     *
     * @param {?} value posição para exibição do elemento
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var position = value || 'bottom';
        this.elementPosition(position);
        this.customPositions && this.customPositions.length ? this.adjustCustomPosition(position) : this.adjustDefaultPosition(position);
    };
    /**
     * @description Retorna a direção da seta, conforme a posição do elemento.
     */
    /**
     * \@description Retorna a direção da seta, conforme a posição do elemento.
     * @return {?}
     */
    PoControlPositionService.prototype.getArrowDirection = /**
     * \@description Retorna a direção da seta, conforme a posição do elemento.
     * @return {?}
     */
    function () {
        return this.arrowDirection;
    };
    /**
     * @description Método responsável por definir as propriedades utilizadas para exibir o elemento na posição correta.
     *
     * @param element elemento que será exibido
     * @param elementOffset offSet do elemento
     * @param targetElement elemento de onde deve partir a exibição
     * @param customPositions posições que sobrescreve as posições padrões
     * @param isSetElementWidth indica se deve definir o tamanho do elemento a ser exibido, caso for verdadeiro será igual do targetElement
     * @param isCornerAligned indica se o elemento filho será alinhado nos cantos do elemneto pai.
     */
    /**
     * \@description Método responsável por definir as propriedades utilizadas para exibir o elemento na posição correta.
     *
     * @param {?} element elemento que será exibido
     * @param {?} elementOffset offSet do elemento
     * @param {?} targetElement elemento de onde deve partir a exibição
     * @param {?=} customPositions posições que sobrescreve as posições padrões
     * @param {?=} isSetElementWidth indica se deve definir o tamanho do elemento a ser exibido, caso for verdadeiro será igual do targetElement
     * @param {?=} isCornerAligned indica se o elemento filho será alinhado nos cantos do elemneto pai.
     * @return {?}
     */
    PoControlPositionService.prototype.setElements = /**
     * \@description Método responsável por definir as propriedades utilizadas para exibir o elemento na posição correta.
     *
     * @param {?} element elemento que será exibido
     * @param {?} elementOffset offSet do elemento
     * @param {?} targetElement elemento de onde deve partir a exibição
     * @param {?=} customPositions posições que sobrescreve as posições padrões
     * @param {?=} isSetElementWidth indica se deve definir o tamanho do elemento a ser exibido, caso for verdadeiro será igual do targetElement
     * @param {?=} isCornerAligned indica se o elemento filho será alinhado nos cantos do elemneto pai.
     * @return {?}
     */
    function (element, elementOffset, targetElement, customPositions, isSetElementWidth, isCornerAligned) {
        if (isSetElementWidth === void 0) { isSetElementWidth = false; }
        if (isCornerAligned === void 0) { isCornerAligned = false; }
        this.element = (element instanceof ElementRef) ? element.nativeElement : element;
        this.targetElement = (targetElement instanceof ElementRef) ? targetElement.nativeElement : targetElement;
        this.elementOffset = elementOffset;
        this.customPositions = customPositions;
        this.isSetElementWidth = isSetElementWidth;
        this.isCornerAligned = isCornerAligned;
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.adjustCustomPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var positionLength = this.customPositions.length;
        /** @type {?} */
        var sidesCount = 0;
        while (sidesCount++ < positionLength) {
            if (this.overflowAllSides(position)) {
                position = this.nextPosition(position, this.customPositions);
                this.elementPosition(position);
            }
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.adjustDefaultPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var mainPositions = this.getMainPositions();
        /** @type {?} */
        var mainPositionLength = mainPositions.length;
        /** @type {?} */
        var mainSidesCount = 0;
        while (mainSidesCount++ < mainPositionLength) {
            /** @type {?} */
            var mainPosition = this.getMainPosition(position);
            this.elementPosition(position);
            if (this.overflowMain(mainPosition)) {
                position = this.nextPosition(mainPosition, mainPositions);
                continue;
            }
            else if (this.overflowAllSides(position)) {
                this.verifySubPositions(position);
                return;
            }
            return;
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.elementPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        this.isCornerAligned ? this.setAlignedElementPosition(position) : this.setElementPosition(position);
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.getMainPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        return (position.indexOf('-') > -1) ? position.substring(0, position.indexOf('-')) : position;
    };
    /**
     * @private
     * @return {?}
     */
    PoControlPositionService.prototype.getMainPositions = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var defaultMainPositions = ['top', 'right', 'bottom', 'left'];
        return this.customPositions && this.customPositions.length ?
            this.getMainPositionsByCustomPositions(this.customPositions) : defaultMainPositions;
    };
    /**
     * @private
     * @param {?} customPositions
     * @return {?}
     */
    PoControlPositionService.prototype.getMainPositionsByCustomPositions = /**
     * @private
     * @param {?} customPositions
     * @return {?}
     */
    function (customPositions) {
        /** @type {?} */
        var mainPositions = [];
        /** @type {?} */
        var customPositionsLength = customPositions.length;
        for (var i = 0; i < customPositionsLength; i++) {
            /** @type {?} */
            var position = customPositions[i];
            /** @type {?} */
            var mainPosition = this.getMainPosition(position);
            if (!mainPositions.includes(mainPosition)) {
                mainPositions.push(mainPosition);
            }
        }
        return mainPositions;
    };
    /**
     * @private
     * @return {?}
     */
    PoControlPositionService.prototype.getOverflows = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var sizesAndPositions = this.getSizesAndPositions();
        return {
            right: (sizesAndPositions.element.right > sizesAndPositions.window.innerWidth),
            top: (sizesAndPositions.element.top <= 0),
            left: (sizesAndPositions.element.left <= 0),
            bottom: (sizesAndPositions.element.bottom > sizesAndPositions.window.innerHeight)
        };
    };
    /**
     * @private
     * @return {?}
     */
    PoControlPositionService.prototype.getSizesAndPositions = /**
     * @private
     * @return {?}
     */
    function () {
        return {
            window: {
                scrollY: window.scrollY,
                scrollX: window.scrollX,
                innerWidth: window.innerWidth,
                innerHeight: window.innerHeight
            },
            element: this.element.getBoundingClientRect(),
            target: this.targetElement ? this.targetElement.getBoundingClientRect() : { top: 0, bottom: 0, right: 0, left: 0 }
        };
    };
    /**
     * @private
     * @param {?} position
     * @param {?=} positions
     * @return {?}
     */
    PoControlPositionService.prototype.nextPosition = /**
     * @private
     * @param {?} position
     * @param {?=} positions
     * @return {?}
     */
    function (position, positions) {
        if (positions === void 0) { positions = []; }
        /** @type {?} */
        var index = positions.indexOf(position);
        /** @type {?} */
        var nextIndex = index + 1;
        if (index > -1 && nextIndex < positions.length) {
            return positions[nextIndex];
        }
        else {
            return positions[0];
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.overflowAllSides = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var overflows = this.getOverflows();
        switch (position) {
            case 'top': return overflows.top || overflows.right || overflows.left;
            case 'top-right': return overflows.top || overflows.right;
            case 'top-left': return overflows.top || overflows.left;
            case 'right': return overflows.right || overflows.top || overflows.bottom;
            case 'right-top': return overflows.right || overflows.top;
            case 'right-bottom': return overflows.right || overflows.bottom;
            case 'bottom': return overflows.bottom || overflows.right || overflows.left;
            case 'bottom-right': return overflows.bottom || overflows.right;
            case 'bottom-left': return overflows.bottom || overflows.left;
            case 'left': return overflows.left || overflows.top || overflows.bottom;
            case 'left-top': return overflows.left || overflows.top;
            case 'left-bottom': return overflows.left || overflows.bottom;
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.overflowMain = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var overflows = this.getOverflows();
        switch (position) {
            case 'top': return overflows.top;
            case 'right': return overflows.right;
            case 'bottom': return overflows.bottom;
            case 'left': return overflows.left;
        }
    };
    /**
     * @private
     * @param {?} elementPosition
     * @return {?}
     */
    PoControlPositionService.prototype.setAlignedArrowDirection = /**
     * @private
     * @param {?} elementPosition
     * @return {?}
     */
    function (elementPosition) {
        switch (elementPosition) {
            case 'top-left': return 'bottom-left';
            case 'top-right': return 'bottom-right';
            case 'bottom-right': return 'top-right';
            case 'bottom-left': return 'top-left';
        }
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    PoControlPositionService.prototype.setAlignedBottomPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.bottom + this.elementOffset + 'px';
        this.element.style.left = sizesAndPositions.target.left - displacement + 'px';
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.setAlignedElementPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        this.setElementWidth();
        /** @type {?} */
        var sizesAndPositions = this.getSizesAndPositions();
        switch (position) {
            case 'bottom-left':
                this.setAlignedBottomPositions(0, sizesAndPositions);
                break;
            case 'bottom-right':
                this.setAlignedBottomPositions(sizesAndPositions.element.width - sizesAndPositions.target.width, sizesAndPositions);
                break;
            case 'top-left':
                this.setAlignedTopPositions(0, sizesAndPositions);
                break;
            case 'top-right':
                this.setAlignedTopPositions(sizesAndPositions.element.width - sizesAndPositions.target.width, sizesAndPositions);
                break;
        }
        this.arrowDirection = this.setAlignedArrowDirection(position);
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    PoControlPositionService.prototype.setAlignedTopPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.top - sizesAndPositions.element.height - this.elementOffset + 'px';
        this.element.style.left = sizesAndPositions.target.left - displacement + 'px';
    };
    /**
     * @private
     * @param {?} elementPosition
     * @return {?}
     */
    PoControlPositionService.prototype.setArrowDirection = /**
     * @private
     * @param {?} elementPosition
     * @return {?}
     */
    function (elementPosition) {
        switch (elementPosition) {
            case 'top': return 'bottom';
            case 'top-left': return 'bottom-right';
            case 'top-right': return 'bottom-left';
            case 'right': return 'left';
            case 'right-top': return 'left-bottom';
            case 'right-bottom': return 'left-top';
            case 'bottom': return 'top';
            case 'bottom-right': return 'top-left';
            case 'bottom-left': return 'top-right';
            case 'left': return 'right';
            case 'left-bottom': return 'right-top';
            case 'left-top': return 'right-bottom';
        }
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    PoControlPositionService.prototype.setBottomPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.bottom + this.elementOffset + 'px';
        this.element.style.left = sizesAndPositions.target.left + (sizesAndPositions.target.width / 2) - displacement + 'px';
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.setElementPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        this.setElementWidth();
        /** @type {?} */
        var sizesAndPositions = this.getSizesAndPositions();
        switch (position) {
            case 'top':
                this.setTopPositions((sizesAndPositions.element.width / 2), sizesAndPositions);
                break;
            case 'top-left':
                this.setTopPositions((sizesAndPositions.element.width - this.offsetArrow - this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'top-right':
                this.setTopPositions((this.offsetArrow + this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'right':
                this.setRightPositions((sizesAndPositions.element.height / 2), sizesAndPositions);
                break;
            case 'right-top':
                this.setRightPositions((sizesAndPositions.element.height - this.offsetArrow - this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'right-bottom':
                this.setRightPositions(this.offsetArrow, sizesAndPositions);
                break;
            case 'bottom':
                this.setBottomPositions((sizesAndPositions.element.width / 2), sizesAndPositions);
                break;
            case 'bottom-right':
                this.setBottomPositions((this.offsetArrow + this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'bottom-left':
                this.setBottomPositions((sizesAndPositions.element.width - this.offsetArrow - this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'left':
                this.setLeftPositions((sizesAndPositions.element.height / 2), sizesAndPositions);
                break;
            case 'left-bottom':
                this.setLeftPositions(this.offsetArrow, sizesAndPositions);
                break;
            case 'left-top':
                this.setLeftPositions((sizesAndPositions.element.height - this.offsetArrow), sizesAndPositions);
                break;
        }
        this.arrowDirection = this.setArrowDirection(position);
    };
    /**
     * @private
     * @return {?}
     */
    PoControlPositionService.prototype.setElementWidth = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.isSetElementWidth && this.targetElement) {
            this.element.style.width = this.targetElement.clientWidth + "px";
        }
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    PoControlPositionService.prototype.setLeftPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.top - displacement + (sizesAndPositions.target.height / 2) + 'px';
        this.element.style.left = sizesAndPositions.target.left - sizesAndPositions.element.width - this.elementOffset + 'px';
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    PoControlPositionService.prototype.setRightPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.top - displacement + (sizesAndPositions.target.height / 2) + 'px';
        this.element.style.left = sizesAndPositions.target.right + this.elementOffset + 'px';
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    PoControlPositionService.prototype.setTopPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.top - sizesAndPositions.element.height - this.elementOffset + 'px';
        this.element.style.left = sizesAndPositions.target.left + (sizesAndPositions.target.width / 2) - displacement + 'px';
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    PoControlPositionService.prototype.verifySubPositions = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        if (position.indexOf('-') > -1) {
            position = position.substring(0, position.indexOf('-'));
            this.elementPosition(position);
        }
        /** @type {?} */
        var align = 0;
        while (align++ < 3) {
            if (this.overflowAllSides(position)) {
                position = this.nextPosition(position, poControlPositionSidesDefault);
                this.elementPosition(position);
            }
            else {
                return null;
            }
        }
    };
    PoControlPositionService.decorators = [
        { type: Injectable }
    ];
    return PoControlPositionService;
}());
export { PoControlPositionService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.arrowDirection;
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.customPositions;
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.differenceDiagonalToWidthArrow;
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.element;
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.elementOffset;
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.isCornerAligned;
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.isSetElementWidth;
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.offsetArrow;
    /**
     * @type {?}
     * @private
     */
    PoControlPositionService.prototype.targetElement;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tY29udHJvbC1wb3NpdGlvbi5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHBvcnRpbmFyaS9wb3J0aW5hcmktdWkvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvcG8tY29udHJvbC1wb3NpdGlvbi9wby1jb250cm9sLXBvc2l0aW9uLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBMEJqRCw2QkFBNkIsR0FBa0I7SUFDbkQsUUFBUSxFQUFFLGFBQWEsRUFBRSxjQUFjO0lBQ3ZDLE1BQU0sRUFBRSxVQUFVLEVBQUUsYUFBYTtJQUNqQyxLQUFLLEVBQUUsV0FBVyxFQUFFLFVBQVU7SUFDOUIsT0FBTyxFQUFFLGNBQWMsRUFBRSxXQUFXO0NBQ3JDO0FBRUQ7SUFBQTtRQUtVLG1DQUE4QixHQUFXLENBQUMsQ0FBQztRQUkzQyxzQkFBaUIsR0FBWSxLQUFLLENBQUM7O1FBRW5DLGdCQUFXLEdBQVcsRUFBRSxDQUFDO0lBMFVuQyxDQUFDO0lBdlVDOzs7O09BSUc7Ozs7Ozs7SUFDSCxpREFBYzs7Ozs7O0lBQWQsVUFBZSxLQUFhOztZQUNwQixRQUFRLEdBQUcsS0FBSyxJQUFJLFFBQVE7UUFDbEMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUMvQixJQUFJLENBQUMsZUFBZSxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNuSSxDQUFDO0lBRUQ7O09BRUc7Ozs7O0lBQ0gsb0RBQWlCOzs7O0lBQWpCO1FBQ0UsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQzdCLENBQUM7SUFFRDs7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LDJDQUE2Qjs7Ozs7SUFDN0IsaURBQThCOzs7OztJQUM5QixtREFBaUM7Ozs7O0lBQ2pDLHFEQUEyQzs7Ozs7SUFFM0MsK0NBQWlDOzs7OztJQUNqQyxpREFBbUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFbGVtZW50UmVmLCBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbiAvKipcbiAgKiBAZG9jc1ByaXZhdGVcbiAgKiBAZGVzY3JpcHRpb25cbiAgKlxuICAqIFNlcnZpw6dvIHJlc3BvbnPDoXZlbCBwb3IgZ2VyZW5jaWFyIGFzIHBvc2nDp8O1ZXMgZGUgdW0gZWxlbWVudG8gZW0gcmVsYcOnw6NvIGEgdW0gZWxlbWVudG8gYWx2by4gRWxlIHBvZGUgcmVjZWJlciBhc1xuICAqIHNlZ3VpbnRlcyBwb3Npw6fDtWVzOlxuICAqXG4gICogLSBgcmlnaHRgOiBQb3NpY2lvbmEgbyBlbGVtZW50byBubyBsYWRvIGRpcmVpdG8gZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqIC0gYHJpZ2h0LWJvdHRvbWA6IFBvc2ljaW9uYSBvIGVsZW1lbnRvIG5vIGxhZG8gZGlyZWl0byBpbmZlcmlvciBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgcmlnaHQtdG9wYDogUG9zaWNpb25hIG8gZWxlbWVudG8gbm8gbGFkbyBkaXJlaXRvIHN1cGVyaW9yIGRvIGNvbXBvbmVudGUgYWx2by5cbiAgKiAtIGBib3R0b21gOiBQb3NpY2lvbmEgbyBlbGVtZW50byBhYmFpeG8gZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqIC0gYGJvdHRvbS1sZWZ0YDogUG9zaWNpb25hIG8gZWxlbWVudG8gYWJhaXhvIGUgw6AgZXNxdWVyZGEgZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqIC0gYGJvdHRvbS1yaWdodGA6IFBvc2ljaW9uYSBvIGVsZW1lbnRvIGFiYWl4byBlIMOgIGRpcmVpdGEgZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqIC0gYGxlZnRgOiBQb3NpY2lvbmEgbyBlbGVtZW50byBubyBsYWRvIGVzcXVlcmRvIGRvIGNvbXBvbmVudGUgYWx2by5cbiAgKiAtIGBsZWZ0LXRvcGA6IFBvc2ljaW9uYSBvIGVsZW1lbnRvIG5vIGxhZG8gZXNxdWVyZG8gc3VwZXJpb3IgZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqIC0gYGxlZnQtYm90dG9tYDogUG9zaWNpb25hIG8gZWxlbWVudG8gbm8gbGFkbyBlc3F1ZXJkbyBpbmZlcmlvciBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgdG9wYDogUG9zaWNpb25hIG8gZWxlbWVudG8gYWNpbWEgZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqIC0gYHRvcC1yaWdodGA6IFBvc2ljaW9uYSBvIGVsZW1lbnRvIGFjaW1hIGUgw6AgZGlyZWl0YSBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgdG9wLWxlZnRgOiBQb3NpY2lvbmEgbyBlbGVtZW50byBhY2ltYSBlIMOgIGVzcXVlcmRhIGRvIGNvbXBvbmVudGUgYWx2by5cbiAgKlxuICAqIENhc28gbyBlbGVtZW50byBuw6NvIGNhaWJhIG5hIHRlbGEgbmEgcG9zacOnw6NvIGluZGljYWRhIGVsZSBzZXLDoSByb3RhY2lvbmFkbyBhdXRvbWF0aWNhbWVudGUgcGFyYSBzZSBhZGVxdWFyLFxuICAqIGluaWNpYWxtZW50ZSBubyBsYWRvIGRlZmluaWRvIGNvbW8gcGFkcsOjbyBlIGVtIHNlZ3VpZGEgc2VndWluZG8gbyBzZW50aWRvIGhvcsOhcmlvLlxuICAqL1xuXG5jb25zdCBwb0NvbnRyb2xQb3NpdGlvblNpZGVzRGVmYXVsdDogQXJyYXk8c3RyaW5nPiA9IFtcbiAgJ2JvdHRvbScsICdib3R0b20tbGVmdCcsICdib3R0b20tcmlnaHQnLFxuICAnbGVmdCcsICdsZWZ0LXRvcCcsICdsZWZ0LWJvdHRvbScsXG4gICd0b3AnLCAndG9wLXJpZ2h0JywgJ3RvcC1sZWZ0JyxcbiAgJ3JpZ2h0JywgJ3JpZ2h0LWJvdHRvbScsICdyaWdodC10b3AnXG5dO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgUG9Db250cm9sUG9zaXRpb25TZXJ2aWNlIHtcblxuICBwcml2YXRlIGFycm93RGlyZWN0aW9uOiBzdHJpbmc7XG4gIHByaXZhdGUgY3VzdG9tUG9zaXRpb25zOiBBcnJheTxzdHJpbmc+O1xuICBwcml2YXRlIGRpZmZlcmVuY2VEaWFnb25hbFRvV2lkdGhBcnJvdzogbnVtYmVyID0gMztcbiAgcHJpdmF0ZSBlbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgcHJpdmF0ZSBlbGVtZW50T2Zmc2V0OiBudW1iZXI7XG4gIHByaXZhdGUgaXNDb3JuZXJBbGlnbmVkOiBib29sZWFuO1xuICBwcml2YXRlIGlzU2V0RWxlbWVudFdpZHRoOiBib29sZWFuID0gZmFsc2U7XG4gIC8vIG9mZnNldCBkYSBzZXRhIGVtIHJlbGHDp8OjbyBhbyBjYW50byBkbyBjb21wb25lbnRlXG4gIHByaXZhdGUgb2Zmc2V0QXJyb3c6IG51bWJlciA9IDEyO1xuICBwcml2YXRlIHRhcmdldEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb24gQWp1c3RhIGEgcG9zacOnw6NvIGRvIGVsZW1lbnRvLCBjYXNvIG7Do28gY291YmVyIGVtIHRlbGEgaXLDoSBwYXJhIHByw7N4aW1hIHBvc2nDp8Ojby5cbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIHBvc2nDp8OjbyBwYXJhIGV4aWJpw6fDo28gZG8gZWxlbWVudG9cbiAgICovXG4gIGFkanVzdFBvc2l0aW9uKHZhbHVlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBwb3NpdGlvbiA9IHZhbHVlIHx8ICdib3R0b20nO1xuICAgIHRoaXMuZWxlbWVudFBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgICB0aGlzLmN1c3RvbVBvc2l0aW9ucyAmJiB0aGlzLmN1c3RvbVBvc2l0aW9ucy5sZW5ndGggPyB0aGlzLmFkanVzdEN1c3RvbVBvc2l0aW9uKHBvc2l0aW9uKSA6IHRoaXMuYWRqdXN0RGVmYXVsdFBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb24gUmV0b3JuYSBhIGRpcmXDp8OjbyBkYSBzZXRhLCBjb25mb3JtZSBhIHBvc2nDp8OjbyBkbyBlbGVtZW50by5cbiAgICovXG4gIGdldEFycm93RGlyZWN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmFycm93RGlyZWN0aW9uO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiBNw6l0b2RvIHJlc3BvbnPDoXZlbCBwb3IgZGVmaW5pciBhcyBwcm9wcmllZGFkZXMgdXRpbGl6YWRhcyBwYXJhIGV4aWJpciBvIGVsZW1lbnRvIG5hIHBvc2nDp8OjbyBjb3JyZXRhLlxuICAgKlxuICAgKiBAcGFyYW0gZWxlbWVudCBlbGVtZW50byBxdWUgc2Vyw6EgZXhpYmlkb1xuICAgKiBAcGFyYW0gZWxlbWVudE9mZnNldCBvZmZTZXQgZG8gZWxlbWVudG9cbiAgICogQHBhcmFtIHRhcmdldEVsZW1lbnQgZWxlbWVudG8gZGUgb25kZSBkZXZlIHBhcnRpciBhIGV4aWJpw6fDo29cbiAgICogQHBhcmFtIGN1c3RvbVBvc2l0aW9ucyBwb3Npw6fDtWVzIHF1ZSBzb2JyZXNjcmV2ZSBhcyBwb3Npw6fDtWVzIHBhZHLDtWVzXG4gICAqIEBwYXJhbSBpc1NldEVsZW1lbnRXaWR0aCBpbmRpY2Egc2UgZGV2ZSBkZWZpbmlyIG8gdGFtYW5obyBkbyBlbGVtZW50byBhIHNlciBleGliaWRvLCBjYXNvIGZvciB2ZXJkYWRlaXJvIHNlcsOhIGlndWFsIGRvIHRhcmdldEVsZW1lbnRcbiAgICogQHBhcmFtIGlzQ29ybmVyQWxpZ25lZCBpbmRpY2Egc2UgbyBlbGVtZW50byBmaWxobyBzZXLDoSBhbGluaGFkbyBub3MgY2FudG9zIGRvIGVsZW1uZXRvIHBhaS5cbiAgICovXG4gIHNldEVsZW1lbnRzKGVsZW1lbnQ6IEVsZW1lbnRSZWYgfCBIVE1MRWxlbWVudCwgZWxlbWVudE9mZnNldDogbnVtYmVyLCB0YXJnZXRFbGVtZW50OiBFbGVtZW50UmVmIHwgSFRNTEVsZW1lbnQsXG4gICAgICAgICAgICAgIGN1c3RvbVBvc2l0aW9ucz86IEFycmF5PHN0cmluZz4sIGlzU2V0RWxlbWVudFdpZHRoOiBib29sZWFuID0gZmFsc2UsIGlzQ29ybmVyQWxpZ25lZDogYm9vbGVhbiA9IGZhbHNlKSB7XG5cbiAgICB0aGlzLmVsZW1lbnQgPSAoZWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnRSZWYpID8gZWxlbWVudC5uYXRpdmVFbGVtZW50IDogZWxlbWVudDtcbiAgICB0aGlzLnRhcmdldEVsZW1lbnQgPSAodGFyZ2V0RWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnRSZWYpID8gdGFyZ2V0RWxlbWVudC5uYXRpdmVFbGVtZW50IDogdGFyZ2V0RWxlbWVudDtcblxuICAgIHRoaXMuZWxlbWVudE9mZnNldCA9IGVsZW1lbnRPZmZzZXQ7XG5cbiAgICB0aGlzLmN1c3RvbVBvc2l0aW9ucyA9IGN1c3RvbVBvc2l0aW9ucztcbiAgICB0aGlzLmlzU2V0RWxlbWVudFdpZHRoID0gaXNTZXRFbGVtZW50V2lkdGg7XG4gICAgdGhpcy5pc0Nvcm5lckFsaWduZWQgPSBpc0Nvcm5lckFsaWduZWQ7XG4gIH1cblxuICBwcml2YXRlIGFkanVzdEN1c3RvbVBvc2l0aW9uKHBvc2l0aW9uOiBzdHJpbmcpIHtcbiAgICBjb25zdCBwb3NpdGlvbkxlbmd0aCA9IHRoaXMuY3VzdG9tUG9zaXRpb25zLmxlbmd0aDtcblxuICAgIGxldCBzaWRlc0NvdW50ID0gMDtcblxuICAgIHdoaWxlIChzaWRlc0NvdW50KysgPCBwb3NpdGlvbkxlbmd0aCkge1xuICAgICAgaWYgKHRoaXMub3ZlcmZsb3dBbGxTaWRlcyhwb3NpdGlvbikpIHtcbiAgICAgICAgcG9zaXRpb24gPSB0aGlzLm5leHRQb3NpdGlvbihwb3NpdGlvbiwgdGhpcy5jdXN0b21Qb3NpdGlvbnMpO1xuICAgICAgICB0aGlzLmVsZW1lbnRQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhZGp1c3REZWZhdWx0UG9zaXRpb24ocG9zaXRpb246IHN0cmluZykge1xuICAgIGNvbnN0IG1haW5Qb3NpdGlvbnMgPSB0aGlzLmdldE1haW5Qb3NpdGlvbnMoKTtcbiAgICBjb25zdCBtYWluUG9zaXRpb25MZW5ndGggPSBtYWluUG9zaXRpb25zLmxlbmd0aDtcblxuICAgIGxldCBtYWluU2lkZXNDb3VudCA9IDA7XG5cbiAgICB3aGlsZSAobWFpblNpZGVzQ291bnQrKyA8IG1haW5Qb3NpdGlvbkxlbmd0aCkge1xuICAgICAgY29uc3QgbWFpblBvc2l0aW9uID0gdGhpcy5nZXRNYWluUG9zaXRpb24ocG9zaXRpb24pO1xuICAgICAgdGhpcy5lbGVtZW50UG9zaXRpb24ocG9zaXRpb24pO1xuXG4gICAgICBpZiAodGhpcy5vdmVyZmxvd01haW4obWFpblBvc2l0aW9uKSkge1xuICAgICAgICBwb3NpdGlvbiA9IHRoaXMubmV4dFBvc2l0aW9uKG1haW5Qb3NpdGlvbiwgbWFpblBvc2l0aW9ucyk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm92ZXJmbG93QWxsU2lkZXMocG9zaXRpb24pKSB7XG4gICAgICAgIHRoaXMudmVyaWZ5U3ViUG9zaXRpb25zKHBvc2l0aW9uKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBlbGVtZW50UG9zaXRpb24ocG9zaXRpb246IHN0cmluZykge1xuICAgIHRoaXMuaXNDb3JuZXJBbGlnbmVkID8gdGhpcy5zZXRBbGlnbmVkRWxlbWVudFBvc2l0aW9uKHBvc2l0aW9uKSA6IHRoaXMuc2V0RWxlbWVudFBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TWFpblBvc2l0aW9uKHBvc2l0aW9uOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gKHBvc2l0aW9uLmluZGV4T2YoJy0nKSA+IC0xKSA/IHBvc2l0aW9uLnN1YnN0cmluZygwLCBwb3NpdGlvbi5pbmRleE9mKCctJykpIDogcG9zaXRpb247XG4gIH1cblxuICBwcml2YXRlIGdldE1haW5Qb3NpdGlvbnMoKSB7XG4gICAgY29uc3QgZGVmYXVsdE1haW5Qb3NpdGlvbnMgPSBbJ3RvcCcsICdyaWdodCcsICdib3R0b20nLCAnbGVmdCddO1xuXG4gICAgcmV0dXJuIHRoaXMuY3VzdG9tUG9zaXRpb25zICYmIHRoaXMuY3VzdG9tUG9zaXRpb25zLmxlbmd0aCA/XG4gICAgICB0aGlzLmdldE1haW5Qb3NpdGlvbnNCeUN1c3RvbVBvc2l0aW9ucyh0aGlzLmN1c3RvbVBvc2l0aW9ucykgOiBkZWZhdWx0TWFpblBvc2l0aW9ucztcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TWFpblBvc2l0aW9uc0J5Q3VzdG9tUG9zaXRpb25zKGN1c3RvbVBvc2l0aW9uczogQXJyYXk8c3RyaW5nPikge1xuICAgIGNvbnN0IG1haW5Qb3NpdGlvbnMgPSBbXTtcbiAgICBjb25zdCBjdXN0b21Qb3NpdGlvbnNMZW5ndGggPSBjdXN0b21Qb3NpdGlvbnMubGVuZ3RoO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjdXN0b21Qb3NpdGlvbnNMZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgcG9zaXRpb24gPSBjdXN0b21Qb3NpdGlvbnNbaV07XG5cbiAgICAgIGNvbnN0IG1haW5Qb3NpdGlvbiA9IHRoaXMuZ2V0TWFpblBvc2l0aW9uKHBvc2l0aW9uKTtcblxuICAgICAgaWYgKCFtYWluUG9zaXRpb25zLmluY2x1ZGVzKG1haW5Qb3NpdGlvbikpIHtcbiAgICAgICAgbWFpblBvc2l0aW9ucy5wdXNoKG1haW5Qb3NpdGlvbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG1haW5Qb3NpdGlvbnM7XG4gIH1cblxuICBwcml2YXRlIGdldE92ZXJmbG93cygpIHtcbiAgICBjb25zdCBzaXplc0FuZFBvc2l0aW9ucyA9IHRoaXMuZ2V0U2l6ZXNBbmRQb3NpdGlvbnMoKTtcblxuICAgIHJldHVybiB7XG4gICAgICByaWdodDogKHNpemVzQW5kUG9zaXRpb25zLmVsZW1lbnQucmlnaHQgPiBzaXplc0FuZFBvc2l0aW9ucy53aW5kb3cuaW5uZXJXaWR0aCksXG4gICAgICB0b3A6IChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LnRvcCA8PSAwKSxcbiAgICAgIGxlZnQ6IChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LmxlZnQgPD0gMCksXG4gICAgICBib3R0b206IChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LmJvdHRvbSA+IHNpemVzQW5kUG9zaXRpb25zLndpbmRvdy5pbm5lckhlaWdodClcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRTaXplc0FuZFBvc2l0aW9ucygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2luZG93OiB7XG4gICAgICAgIHNjcm9sbFk6IHdpbmRvdy5zY3JvbGxZLFxuICAgICAgICBzY3JvbGxYOiB3aW5kb3cuc2Nyb2xsWCxcbiAgICAgICAgaW5uZXJXaWR0aDogd2luZG93LmlubmVyV2lkdGgsXG4gICAgICAgIGlubmVySGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHRcbiAgICAgIH0sXG4gICAgICBlbGVtZW50OiB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICB0YXJnZXQ6IHRoaXMudGFyZ2V0RWxlbWVudCA/IHRoaXMudGFyZ2V0RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6IHsgdG9wOiAwLCBib3R0b206IDAsIHJpZ2h0OiAwLCBsZWZ0OiAwIH1cbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBuZXh0UG9zaXRpb24ocG9zaXRpb246IHN0cmluZywgcG9zaXRpb25zOiBBcnJheTxzdHJpbmc+ID0gW10pOiBzdHJpbmcge1xuICAgIGNvbnN0IGluZGV4ID0gcG9zaXRpb25zLmluZGV4T2YocG9zaXRpb24pO1xuICAgIGNvbnN0IG5leHRJbmRleCA9IGluZGV4ICsgMTtcblxuICAgIGlmIChpbmRleCA+IC0xICYmIG5leHRJbmRleCA8IHBvc2l0aW9ucy5sZW5ndGgpIHtcblxuICAgICAgcmV0dXJuIHBvc2l0aW9uc1tuZXh0SW5kZXhdO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcG9zaXRpb25zWzBdO1xuICAgIH1cblxuICB9XG5cbiAgcHJpdmF0ZSBvdmVyZmxvd0FsbFNpZGVzKHBvc2l0aW9uOiBzdHJpbmcpIHtcbiAgICBjb25zdCBvdmVyZmxvd3MgPSB0aGlzLmdldE92ZXJmbG93cygpO1xuXG4gICAgc3dpdGNoIChwb3NpdGlvbikge1xuICAgICAgY2FzZSAndG9wJzogcmV0dXJuIG92ZXJmbG93cy50b3AgfHwgb3ZlcmZsb3dzLnJpZ2h0IHx8IG92ZXJmbG93cy5sZWZ0O1xuICAgICAgY2FzZSAndG9wLXJpZ2h0JzogcmV0dXJuIG92ZXJmbG93cy50b3AgfHwgb3ZlcmZsb3dzLnJpZ2h0O1xuICAgICAgY2FzZSAndG9wLWxlZnQnOiByZXR1cm4gb3ZlcmZsb3dzLnRvcCB8fCBvdmVyZmxvd3MubGVmdDtcbiAgICAgIGNhc2UgJ3JpZ2h0JzogcmV0dXJuIG92ZXJmbG93cy5yaWdodCB8fCBvdmVyZmxvd3MudG9wIHx8IG92ZXJmbG93cy5ib3R0b207XG4gICAgICBjYXNlICdyaWdodC10b3AnOiByZXR1cm4gb3ZlcmZsb3dzLnJpZ2h0IHx8IG92ZXJmbG93cy50b3A7XG4gICAgICBjYXNlICdyaWdodC1ib3R0b20nOiByZXR1cm4gb3ZlcmZsb3dzLnJpZ2h0IHx8IG92ZXJmbG93cy5ib3R0b207XG4gICAgICBjYXNlICdib3R0b20nOiByZXR1cm4gb3ZlcmZsb3dzLmJvdHRvbSB8fCBvdmVyZmxvd3MucmlnaHQgfHwgb3ZlcmZsb3dzLmxlZnQ7XG4gICAgICBjYXNlICdib3R0b20tcmlnaHQnOiByZXR1cm4gb3ZlcmZsb3dzLmJvdHRvbSB8fCBvdmVyZmxvd3MucmlnaHQ7XG4gICAgICBjYXNlICdib3R0b20tbGVmdCc6IHJldHVybiBvdmVyZmxvd3MuYm90dG9tIHx8IG92ZXJmbG93cy5sZWZ0O1xuICAgICAgY2FzZSAnbGVmdCc6IHJldHVybiBvdmVyZmxvd3MubGVmdCB8fCBvdmVyZmxvd3MudG9wIHx8IG92ZXJmbG93cy5ib3R0b207XG4gICAgICBjYXNlICdsZWZ0LXRvcCc6IHJldHVybiBvdmVyZmxvd3MubGVmdCB8fCBvdmVyZmxvd3MudG9wO1xuICAgICAgY2FzZSAnbGVmdC1ib3R0b20nOiByZXR1cm4gb3ZlcmZsb3dzLmxlZnQgfHwgb3ZlcmZsb3dzLmJvdHRvbTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIG92ZXJmbG93TWFpbihwb3NpdGlvbjogc3RyaW5nKSB7XG4gICAgY29uc3Qgb3ZlcmZsb3dzID0gdGhpcy5nZXRPdmVyZmxvd3MoKTtcblxuICAgIHN3aXRjaCAocG9zaXRpb24pIHtcbiAgICAgIGNhc2UgJ3RvcCc6IHJldHVybiBvdmVyZmxvd3MudG9wO1xuICAgICAgY2FzZSAncmlnaHQnOiByZXR1cm4gb3ZlcmZsb3dzLnJpZ2h0O1xuICAgICAgY2FzZSAnYm90dG9tJzogcmV0dXJuIG92ZXJmbG93cy5ib3R0b207XG4gICAgICBjYXNlICdsZWZ0JzogcmV0dXJuIG92ZXJmbG93cy5sZWZ0O1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0QWxpZ25lZEFycm93RGlyZWN0aW9uKGVsZW1lbnRQb3NpdGlvbjogc3RyaW5nKSB7XG4gICAgc3dpdGNoIChlbGVtZW50UG9zaXRpb24pIHtcbiAgICAgIGNhc2UgJ3RvcC1sZWZ0JzogcmV0dXJuICdib3R0b20tbGVmdCc7XG4gICAgICBjYXNlICd0b3AtcmlnaHQnOiByZXR1cm4gJ2JvdHRvbS1yaWdodCc7XG4gICAgICBjYXNlICdib3R0b20tcmlnaHQnOiByZXR1cm4gJ3RvcC1yaWdodCc7XG4gICAgICBjYXNlICdib3R0b20tbGVmdCc6IHJldHVybiAndG9wLWxlZnQnO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0QWxpZ25lZEJvdHRvbVBvc2l0aW9ucyhkaXNwbGFjZW1lbnQ6IG51bWJlciwgc2l6ZXNBbmRQb3NpdGlvbnMpIHtcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LmJvdHRvbSArIHRoaXMuZWxlbWVudE9mZnNldCArICdweCc7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQubGVmdCAtIGRpc3BsYWNlbWVudCArICdweCc7XG4gIH1cblxuICBwcml2YXRlIHNldEFsaWduZWRFbGVtZW50UG9zaXRpb24ocG9zaXRpb246IHN0cmluZykge1xuICAgIHRoaXMuc2V0RWxlbWVudFdpZHRoKCk7XG5cbiAgICBjb25zdCBzaXplc0FuZFBvc2l0aW9uczogYW55ID0gdGhpcy5nZXRTaXplc0FuZFBvc2l0aW9ucygpO1xuXG4gICAgc3dpdGNoIChwb3NpdGlvbikge1xuICAgICAgY2FzZSAnYm90dG9tLWxlZnQnOlxuICAgICAgICB0aGlzLnNldEFsaWduZWRCb3R0b21Qb3NpdGlvbnMoMCwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2JvdHRvbS1yaWdodCc6XG4gICAgICAgIHRoaXMuc2V0QWxpZ25lZEJvdHRvbVBvc2l0aW9ucyhzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LndpZHRoIC0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LndpZHRoLCBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndG9wLWxlZnQnOlxuICAgICAgICB0aGlzLnNldEFsaWduZWRUb3BQb3NpdGlvbnMoMCwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RvcC1yaWdodCc6XG4gICAgICAgIHRoaXMuc2V0QWxpZ25lZFRvcFBvc2l0aW9ucyhzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LndpZHRoIC0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LndpZHRoLCBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHRoaXMuYXJyb3dEaXJlY3Rpb24gPSB0aGlzLnNldEFsaWduZWRBcnJvd0RpcmVjdGlvbihwb3NpdGlvbik7XG5cbiAgfVxuXG4gIHByaXZhdGUgc2V0QWxpZ25lZFRvcFBvc2l0aW9ucyhkaXNwbGFjZW1lbnQ6IG51bWJlciwgc2l6ZXNBbmRQb3NpdGlvbnMpIHtcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LnRvcCAtIHNpemVzQW5kUG9zaXRpb25zLmVsZW1lbnQuaGVpZ2h0IC0gdGhpcy5lbGVtZW50T2Zmc2V0ICsgJ3B4JztcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9IHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC5sZWZ0IC0gZGlzcGxhY2VtZW50ICsgJ3B4JztcbiAgfVxuXG4gIHByaXZhdGUgc2V0QXJyb3dEaXJlY3Rpb24oZWxlbWVudFBvc2l0aW9uOiBzdHJpbmcpIHtcbiAgICBzd2l0Y2ggKGVsZW1lbnRQb3NpdGlvbikge1xuICAgICAgY2FzZSAndG9wJzogcmV0dXJuICdib3R0b20nO1xuICAgICAgY2FzZSAndG9wLWxlZnQnOiByZXR1cm4gJ2JvdHRvbS1yaWdodCc7XG4gICAgICBjYXNlICd0b3AtcmlnaHQnOiByZXR1cm4gJ2JvdHRvbS1sZWZ0JztcbiAgICAgIGNhc2UgJ3JpZ2h0JzogcmV0dXJuICdsZWZ0JztcbiAgICAgIGNhc2UgJ3JpZ2h0LXRvcCc6IHJldHVybiAnbGVmdC1ib3R0b20nO1xuICAgICAgY2FzZSAncmlnaHQtYm90dG9tJzogcmV0dXJuICdsZWZ0LXRvcCc7XG4gICAgICBjYXNlICdib3R0b20nOiByZXR1cm4gJ3RvcCc7XG4gICAgICBjYXNlICdib3R0b20tcmlnaHQnOiByZXR1cm4gJ3RvcC1sZWZ0JztcbiAgICAgIGNhc2UgJ2JvdHRvbS1sZWZ0JzogcmV0dXJuICd0b3AtcmlnaHQnO1xuICAgICAgY2FzZSAnbGVmdCc6IHJldHVybiAncmlnaHQnO1xuICAgICAgY2FzZSAnbGVmdC1ib3R0b20nOiByZXR1cm4gJ3JpZ2h0LXRvcCc7XG4gICAgICBjYXNlICdsZWZ0LXRvcCc6IHJldHVybiAncmlnaHQtYm90dG9tJztcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldEJvdHRvbVBvc2l0aW9ucyhkaXNwbGFjZW1lbnQ6IG51bWJlciwgc2l6ZXNBbmRQb3NpdGlvbnMpIHtcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LmJvdHRvbSArIHRoaXMuZWxlbWVudE9mZnNldCArICdweCc7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQubGVmdCArIChzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQud2lkdGggLyAyKSAtIGRpc3BsYWNlbWVudCArICdweCc7XG4gIH1cblxuICBwcml2YXRlIHNldEVsZW1lbnRQb3NpdGlvbihwb3NpdGlvbjogc3RyaW5nKSB7XG4gICAgdGhpcy5zZXRFbGVtZW50V2lkdGgoKTtcblxuICAgIGNvbnN0IHNpemVzQW5kUG9zaXRpb25zID0gdGhpcy5nZXRTaXplc0FuZFBvc2l0aW9ucygpO1xuXG4gICAgc3dpdGNoIChwb3NpdGlvbikge1xuICAgICAgY2FzZSAndG9wJzpcbiAgICAgICAgdGhpcy5zZXRUb3BQb3NpdGlvbnMoKHNpemVzQW5kUG9zaXRpb25zLmVsZW1lbnQud2lkdGggLyAyKSwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RvcC1sZWZ0JzpcbiAgICAgICAgdGhpcy5zZXRUb3BQb3NpdGlvbnMoKHNpemVzQW5kUG9zaXRpb25zLmVsZW1lbnQud2lkdGggLSB0aGlzLm9mZnNldEFycm93IC0gdGhpcy5kaWZmZXJlbmNlRGlhZ29uYWxUb1dpZHRoQXJyb3cpLCBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndG9wLXJpZ2h0JzpcbiAgICAgICAgdGhpcy5zZXRUb3BQb3NpdGlvbnMoKHRoaXMub2Zmc2V0QXJyb3cgKyB0aGlzLmRpZmZlcmVuY2VEaWFnb25hbFRvV2lkdGhBcnJvdyksIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgIHRoaXMuc2V0UmlnaHRQb3NpdGlvbnMoKHNpemVzQW5kUG9zaXRpb25zLmVsZW1lbnQuaGVpZ2h0IC8gMiksIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyaWdodC10b3AnOlxuICAgICAgICB0aGlzLnNldFJpZ2h0UG9zaXRpb25zKChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LmhlaWdodCAtIHRoaXMub2Zmc2V0QXJyb3cgLSB0aGlzLmRpZmZlcmVuY2VEaWFnb25hbFRvV2lkdGhBcnJvdyksXG4gICAgICAgICAgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3JpZ2h0LWJvdHRvbSc6XG4gICAgICAgIHRoaXMuc2V0UmlnaHRQb3NpdGlvbnModGhpcy5vZmZzZXRBcnJvdywgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2JvdHRvbSc6XG4gICAgICAgIHRoaXMuc2V0Qm90dG9tUG9zaXRpb25zKChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LndpZHRoIC8gMiksIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdib3R0b20tcmlnaHQnOlxuICAgICAgICB0aGlzLnNldEJvdHRvbVBvc2l0aW9ucygodGhpcy5vZmZzZXRBcnJvdyArIHRoaXMuZGlmZmVyZW5jZURpYWdvbmFsVG9XaWR0aEFycm93KSwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2JvdHRvbS1sZWZ0JzpcbiAgICAgICAgdGhpcy5zZXRCb3R0b21Qb3NpdGlvbnMoKHNpemVzQW5kUG9zaXRpb25zLmVsZW1lbnQud2lkdGggLSB0aGlzLm9mZnNldEFycm93IC0gdGhpcy5kaWZmZXJlbmNlRGlhZ29uYWxUb1dpZHRoQXJyb3cpLFxuICAgICAgICAgIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgdGhpcy5zZXRMZWZ0UG9zaXRpb25zKChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LmhlaWdodCAvIDIpLCBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbGVmdC1ib3R0b20nOlxuICAgICAgICB0aGlzLnNldExlZnRQb3NpdGlvbnModGhpcy5vZmZzZXRBcnJvdywgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2xlZnQtdG9wJzpcbiAgICAgICAgdGhpcy5zZXRMZWZ0UG9zaXRpb25zKChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LmhlaWdodCAtIHRoaXMub2Zmc2V0QXJyb3cpLCBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHRoaXMuYXJyb3dEaXJlY3Rpb24gPSB0aGlzLnNldEFycm93RGlyZWN0aW9uKHBvc2l0aW9uKTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0RWxlbWVudFdpZHRoKCkge1xuICAgIGlmICh0aGlzLmlzU2V0RWxlbWVudFdpZHRoICYmIHRoaXMudGFyZ2V0RWxlbWVudCkge1xuICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLndpZHRoID0gYCR7dGhpcy50YXJnZXRFbGVtZW50LmNsaWVudFdpZHRofXB4YDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldExlZnRQb3NpdGlvbnMoZGlzcGxhY2VtZW50OiBudW1iZXIsIHNpemVzQW5kUG9zaXRpb25zKSB7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC50b3AgLSBkaXNwbGFjZW1lbnQgKyAoc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LmhlaWdodCAvIDIpICsgJ3B4JztcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9IHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC5sZWZ0IC0gc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC53aWR0aCAtIHRoaXMuZWxlbWVudE9mZnNldCArICdweCc7XG4gIH1cblxuICBwcml2YXRlIHNldFJpZ2h0UG9zaXRpb25zKGRpc3BsYWNlbWVudDogbnVtYmVyLCBzaXplc0FuZFBvc2l0aW9ucykge1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQudG9wIC0gZGlzcGxhY2VtZW50ICsgKHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC5oZWlnaHQgLyAyKSArICdweCc7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQucmlnaHQgKyB0aGlzLmVsZW1lbnRPZmZzZXQgKyAncHgnO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRUb3BQb3NpdGlvbnMoZGlzcGxhY2VtZW50OiBudW1iZXIsIHNpemVzQW5kUG9zaXRpb25zKSB7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC50b3AgLSBzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LmhlaWdodCAtIHRoaXMuZWxlbWVudE9mZnNldCArICdweCc7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQubGVmdCArIChzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQud2lkdGggLyAyKSAtIGRpc3BsYWNlbWVudCArICdweCc7XG4gIH1cblxuICBwcml2YXRlIHZlcmlmeVN1YlBvc2l0aW9ucyhwb3NpdGlvbjogc3RyaW5nKSB7XG4gICAgaWYgKHBvc2l0aW9uLmluZGV4T2YoJy0nKSA+IC0xKSB7XG4gICAgICBwb3NpdGlvbiA9IHBvc2l0aW9uLnN1YnN0cmluZygwLCBwb3NpdGlvbi5pbmRleE9mKCctJykpO1xuICAgICAgdGhpcy5lbGVtZW50UG9zaXRpb24ocG9zaXRpb24pO1xuICAgIH1cblxuICAgIGxldCBhbGlnbiA9IDA7XG4gICAgd2hpbGUgKGFsaWduKysgPCAzKSB7XG4gICAgICBpZiAodGhpcy5vdmVyZmxvd0FsbFNpZGVzKHBvc2l0aW9uKSkge1xuICAgICAgICBwb3NpdGlvbiA9IHRoaXMubmV4dFBvc2l0aW9uKHBvc2l0aW9uLCBwb0NvbnRyb2xQb3NpdGlvblNpZGVzRGVmYXVsdCk7XG4gICAgICAgIHRoaXMuZWxlbWVudFBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG59XG4iXX0=